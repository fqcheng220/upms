-- MySQL Script generated by MySQL Workbench
-- Sun Jun  9 23:22:27 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema db_stone_mall
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `db_stone_mall` ;

-- -----------------------------------------------------
-- Schema db_stone_mall
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `db_stone_mall` DEFAULT CHARACTER SET utf8 ;
USE `db_stone_mall` ;

-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_user` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_user` (
  `userId` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `userName` VARCHAR(45) NOT NULL,
  `pwd` VARCHAR(45) NOT NULL,
  `realName` VARCHAR(45) NULL,
  `phone` VARCHAR(45) NOT NULL,
  `createTime` BIGINT(20) NOT NULL,
  PRIMARY KEY (`userId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_role` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_role` (
  `roleId` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `createTime` BIGINT(20) NOT NULL,
  `description` VARCHAR(45) NULL,
  PRIMARY KEY (`roleId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_user_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_user_role` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_user_role` (
  `id` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `userId` INT NOT NULL,
  `roleId` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_tb_upms_user_role_tb_upms_user_idx` (`userId` ASC),
  INDEX `fk_tb_upms_user_role_tb_upms_role1_idx` (`roleId` ASC),
  CONSTRAINT `fk_tb_upms_user_role_tb_upms_user`
    FOREIGN KEY (`userId`)
    REFERENCES `db_stone_mall`.`tb_upms_user` (`userId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_upms_user_role_tb_upms_role1`
    FOREIGN KEY (`roleId`)
    REFERENCES `db_stone_mall`.`tb_upms_role` (`roleId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`upms_system`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`upms_system` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`upms_system` (
  `systemId` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `description` VARCHAR(200) NULL,
  `status` TINYINT(4) NULL DEFAULT COMMENT '0禁止 1正常',
  `createTime` BIGINT(20) NOT NULL,
  PRIMARY KEY (`systemId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_permission`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_permission` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_permission` (
  `permissionId` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `permissionValue` VARCHAR(45) NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `createTime` BIGINT(20) NULL,
  `type` TINYINT(4) NULL,
  `status` TINYINT(4) NOT NULL DEFAULT COMMENT '0禁止 1正常',
  `upms_system_systemId` INT NOT NULL,
  PRIMARY KEY (`permissionId`),
  INDEX `fk_tb_upms_permission_upms_system1_idx` (`upms_system_systemId` ASC),
  CONSTRAINT `fk_tb_upms_permission_upms_system1`
    FOREIGN KEY (`upms_system_systemId`)
    REFERENCES `db_stone_mall`.`upms_system` (`systemId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_permission_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_permission_role` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_permission_role` (
  `id` INT NOT NULL,
  `permissionId` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `roleId` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_tb_upms_permission_has_tb_upms_role_tb_upms_role1_idx` (`roleId` ASC),
  INDEX `fk_tb_upms_permission_has_tb_upms_role_tb_upms_permission1_idx` (`permissionId` ASC),
  CONSTRAINT `fk_tb_upms_permission_has_tb_upms_role_tb_upms_permission1`
    FOREIGN KEY (`permissionId`)
    REFERENCES `db_stone_mall`.`tb_upms_permission` (`permissionId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_upms_permission_has_tb_upms_role_tb_upms_role1`
    FOREIGN KEY (`roleId`)
    REFERENCES `db_stone_mall`.`tb_upms_role` (`roleId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_user_permission`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_user_permission` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_user_permission` (
  `id` INT NOT NULL DEFAULT AUTO_INCREMENT,
  `userId` INT NOT NULL,
  `permissionId` INT NOT NULL,
  INDEX `fk_tb_upms_user_has_tb_upms_permission_tb_upms_permission1_idx` (`permissionId` ASC),
  INDEX `fk_tb_upms_user_has_tb_upms_permission_tb_upms_user1_idx` (`userId` ASC),
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_tb_upms_user_has_tb_upms_permission_tb_upms_user1`
    FOREIGN KEY (`userId`)
    REFERENCES `db_stone_mall`.`tb_upms_user` (`userId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_upms_user_has_tb_upms_permission_tb_upms_permission1`
    FOREIGN KEY (`permissionId`)
    REFERENCES `db_stone_mall`.`tb_upms_permission` (`permissionId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_upms_user_copy1`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_upms_user_copy1` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_upms_user_copy1` (
  `userId` INT NOT NULL,
  `userName` VARCHAR(45) NOT NULL,
  `pwd` VARCHAR(45) NOT NULL,
  `realName` VARCHAR(45) NULL,
  `phone` VARCHAR(45) NOT NULL,
  `createTime` BIGINT(20) NOT NULL,
  PRIMARY KEY (`userId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_category` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_category` (
  `categoryId` BIGINT(20) NOT NULL COMMENT '分类ID',
  `parentId` BIGINT(20) NULL COMMENT '父分类ID',
  `name` VARCHAR(64) NULL COMMENT '分类名称',
  `sort` INT NULL COMMENT '排序',
  `status` TINYINT(2) NULL DEFAULT 0 COMMENT '状态 1-显示 0-隐藏',
  `type` TINYINT(2) NULL COMMENT '目录类型 2=二级目录/1=一级目录/0=总目录',
  `showInNav` TINYINT(2) NULL DEFAULT 0 COMMENT '是否导航栏 1=显示/0=隐藏',
  `showInTop` TINYINT(2) NULL DEFAULT 0 COMMENT '是否置顶 1=置顶/0=默认',
  `showInHot` TINYINT(2) NULL DEFAULT 0 COMMENT '是否热门 1=热门/0=默认',
  `createTime` DATETIME(6) NULL COMMENT '创建时间',
  `createBy` VARCHAR(64) NULL COMMENT '创建者',
  `updateTime` DATETIME(6) NULL COMMENT '更新时间',
  `updateBy` VARCHAR(64) NULL COMMENT '更新者',
  `pageTitle` VARCHAR(64) NULL COMMENT '页面标题',
  `pageDescription` VARCHAR(64) NULL COMMENT '页面描述',
  `PageKeywords` VARCHAR(64) NULL COMMENT '页面关键词',
  `remark` VARCHAR(255) NULL COMMENT '备注信息',
  PRIMARY KEY (`categoryId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_attr`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_attr` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_attr` (
  `attrId` INT NOT NULL,
  `attrName` VARCHAR(45) NULL,
  `tb_product_category_categoryId` BIGINT(20) NOT NULL,
  PRIMARY KEY (`attrId`, `tb_product_category_categoryId`),
  INDEX `fk_tb_product_attr_tb_product_category1_idx` (`tb_product_category_categoryId` ASC),
  CONSTRAINT `fk_tb_product_attr_tb_product_category1`
    FOREIGN KEY (`tb_product_category_categoryId`)
    REFERENCES `db_stone_mall`.`tb_product_category` (`categoryId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_attr_value`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_attr_value` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_attr_value` (
  `attrValueId` INT NOT NULL,
  `attrValue` VARCHAR(64) NULL,
  `tb_product_attr_attrId` INT NOT NULL,
  PRIMARY KEY (`attrValueId`, `tb_product_attr_attrId`),
  INDEX `fk_tb_product_attr_value_tb_product_attr1_idx` (`tb_product_attr_attrId` ASC),
  CONSTRAINT `fk_tb_product_attr_value_tb_product_attr1`
    FOREIGN KEY (`tb_product_attr_attrId`)
    REFERENCES `db_stone_mall`.`tb_product_attr` (`attrId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_spec`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_spec` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_spec` (
  `specId` INT NOT NULL,
  `specName` VARCHAR(45) NULL,
  `tb_product_category_categoryId` BIGINT(20) NOT NULL,
  PRIMARY KEY (`specId`, `tb_product_category_categoryId`),
  INDEX `fk_tb_product_spec_tb_product_category1_idx` (`tb_product_category_categoryId` ASC),
  CONSTRAINT `fk_tb_product_spec_tb_product_category1`
    FOREIGN KEY (`tb_product_category_categoryId`)
    REFERENCES `db_stone_mall`.`tb_product_category` (`categoryId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_spec_value`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_spec_value` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_spec_value` (
  `specValueId` INT NOT NULL,
  `specValue` VARCHAR(45) NULL,
  `tb_product_spec_specId` INT NOT NULL,
  PRIMARY KEY (`specValueId`, `tb_product_spec_specId`),
  INDEX `fk_tb_product_spec_value_tb_product_spec1_idx` (`tb_product_spec_specId` ASC),
  CONSTRAINT `fk_tb_product_spec_value_tb_product_spec1`
    FOREIGN KEY (`tb_product_spec_specId`)
    REFERENCES `db_stone_mall`.`tb_product_spec` (`specId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_brand`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_brand` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_brand` (
  `brandId` INT NOT NULL,
  `brandName` VARCHAR(45) NULL,
  `brandDescrption` VARCHAR(255) NULL,
  PRIMARY KEY (`brandId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_spu`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_spu` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_spu` (
  `spuId` BIGINT(20) NOT NULL,
  `spuNumber` BIGINT(20) NULL COMMENT 'spu编号',
  `spuName` VARCHAR(64) NULL COMMENT '货品名称',
  `introduce` VARCHAR(64) NULL COMMENT '货品简介',
  `showInShelve` TINYINT(2) NULL DEFAULT 0 COMMENT '是否上架：1=上架/0=下架',
  `shelveTime` DATETIME(6) NULL COMMENT '上架时间',
  `shelveBy` VARCHAR(45) NULL COMMENT '上架人',
  `updateTime` DATETIME(6) NULL COMMENT '更新时间',
  `updateBy` VARCHAR(45) NULL COMMENT '更新者',
  `showInTop` TINYINT(2) NULL DEFAULT 0 COMMENT '是否置顶 1=置顶/0=默认',
  `showIinNav` TINYINT(2) NULL COMMENT '是否导航栏 1=显示/0=隐藏',
  `showInHot` TINYINT(2) NULL DEFAULT 0 COMMENT '是否热门 1=热门/0=默认',
  `createTime` DATETIME(6) NULL COMMENT '创建时间',
  `createBy` VARCHAR(45) NULL COMMENT '创建者',
  `videoIntroduce` VARCHAR(255) NULL COMMENT '视频介绍',
  `searchKey` VARCHAR(255) NULL COMMENT '搜索关键词',
  `tb_product_category_categoryId` BIGINT(20) NOT NULL,
  `tb_product_brand_brandId` INT NOT NULL,
  PRIMARY KEY (`spuId`, `tb_product_category_categoryId`, `tb_product_brand_brandId`),
  INDEX `fk_tb_product_spu_tb_product_category1_idx` (`tb_product_category_categoryId` ASC),
  INDEX `fk_tb_product_spu_tb_product_brand1_idx` (`tb_product_brand_brandId` ASC),
  CONSTRAINT `fk_tb_product_spu_tb_product_category1`
    FOREIGN KEY (`tb_product_category_categoryId`)
    REFERENCES `db_stone_mall`.`tb_product_category` (`categoryId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_product_spu_tb_product_brand1`
    FOREIGN KEY (`tb_product_brand_brandId`)
    REFERENCES `db_stone_mall`.`tb_product_brand` (`brandId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_sku`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_sku` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_sku` (
  `skuId` BIGINT(20) NOT NULL,
  `skuNumber` BIGINT(20) NULL COMMENT 'sku编号',
  `skuName` VARCHAR(64) NULL COMMENT '商品名称',
  `introduce` VARCHAR(64) NULL COMMENT '商品简介',
  `showInShelve` TINYINT(2) NULL DEFAULT 0 COMMENT '是否上架：1=上架/0=下架',
  `shelveTime` DATETIME(6) NULL COMMENT '上架时间',
  `shelveBy` VARCHAR(45) NULL COMMENT '上架人',
  `updateTime` DATETIME(6) NULL COMMENT '更新时间',
  `updateBy` VARCHAR(45) NULL COMMENT '更新者',
  `showInTop` TINYINT(2) NULL DEFAULT 0 COMMENT '是否置顶 1=置顶/0=默认',
  `showIinNav` TINYINT(2) NULL COMMENT '是否导航栏 1=显示/0=隐藏',
  `showInHot` TINYINT(2) NULL DEFAULT 0 COMMENT '是否热门 1=热门/0=默认',
  `createTime` DATETIME(6) NULL COMMENT '创建时间',
  `createBy` VARCHAR(45) NULL COMMENT '创建者',
  `picImage` VARCHAR(255) NULL COMMENT '展示图片',
  `searchKey` VARCHAR(255) NULL COMMENT '搜索关键词',
  `price` DECIMAL(10,2) NULL COMMENT '价格',
  `sotck` INT NULL COMMENT '库存',
  `tb_product_spu_spuId` BIGINT(20) NOT NULL,
  PRIMARY KEY (`skuId`, `tb_product_spu_spuId`),
  INDEX `fk_tb_product_sku_tb_product_spu1_idx` (`tb_product_spu_spuId` ASC),
  CONSTRAINT `fk_tb_product_sku_tb_product_spu1`
    FOREIGN KEY (`tb_product_spu_spuId`)
    REFERENCES `db_stone_mall`.`tb_product_spu` (`spuId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_sku_attr_value`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_sku_attr_value` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_sku_attr_value` (
  `id` INT NOT NULL,
  `tb_product_sku_skuId` BIGINT(20) NOT NULL,
  `tb_product_attr_value_attrValueId` INT NOT NULL,
  PRIMARY KEY (`id`, `tb_product_sku_skuId`, `tb_product_attr_value_attrValueId`),
  INDEX `fk_tb_product_sku_attr_value_tb_product_sku1_idx` (`tb_product_sku_skuId` ASC),
  INDEX `fk_tb_product_sku_attr_value_tb_product_attr_value1_idx` (`tb_product_attr_value_attrValueId` ASC),
  CONSTRAINT `fk_tb_product_sku_attr_value_tb_product_sku1`
    FOREIGN KEY (`tb_product_sku_skuId`)
    REFERENCES `db_stone_mall`.`tb_product_sku` (`skuId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_product_sku_attr_value_tb_product_attr_value1`
    FOREIGN KEY (`tb_product_attr_value_attrValueId`)
    REFERENCES `db_stone_mall`.`tb_product_attr_value` (`attrValueId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_sku_spec_value`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_sku_spec_value` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_sku_spec_value` (
  `id` INT NOT NULL,
  `tb_product_spec_value_specValueId` INT NOT NULL,
  `tb_product_sku_skuId` BIGINT(20) NOT NULL,
  PRIMARY KEY (`id`, `tb_product_spec_value_specValueId`, `tb_product_sku_skuId`),
  INDEX `fk_tb_product_sku_spec_value_tb_product_spec_value1_idx` (`tb_product_spec_value_specValueId` ASC),
  INDEX `fk_tb_product_sku_spec_value_tb_product_sku1_idx` (`tb_product_sku_skuId` ASC),
  CONSTRAINT `fk_tb_product_sku_spec_value_tb_product_spec_value1`
    FOREIGN KEY (`tb_product_spec_value_specValueId`)
    REFERENCES `db_stone_mall`.`tb_product_spec_value` (`specValueId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_tb_product_sku_spec_value_tb_product_sku1`
    FOREIGN KEY (`tb_product_sku_skuId`)
    REFERENCES `db_stone_mall`.`tb_product_sku` (`skuId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `db_stone_mall`.`tb_product_spu_img`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `db_stone_mall`.`tb_product_spu_img` ;

CREATE TABLE IF NOT EXISTS `db_stone_mall`.`tb_product_spu_img` (
  `id` INT NOT NULL,
  `path` VARCHAR(255) NULL,
  `sort` INT NULL,
  `statue` TINYINT(2) NULL,
  `tb_product_spu_spuId` BIGINT(20) NOT NULL,
  PRIMARY KEY (`id`, `tb_product_spu_spuId`),
  INDEX `fk_tb_product_spu_img_tb_product_spu1_idx` (`tb_product_spu_spuId` ASC),
  CONSTRAINT `fk_tb_product_spu_img_tb_product_spu1`
    FOREIGN KEY (`tb_product_spu_spuId`)
    REFERENCES `db_stone_mall`.`tb_product_spu` (`spuId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
